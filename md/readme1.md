# SCBC-ORC联合循环系统模拟与优化

## 1. 项目概述

本项目实现了超临界CO2布雷顿循环(SCBC)与有机朗肯循环(ORC)耦合的余热回收系统模拟与优化。该系统利用SCBC循环的废热为ORC循环提供热源，实现能源的梯级利用，提高整体热效率。

### 主要特点
- 完整模拟SCBC与ORC耦合系统
- 基于四个关键变量的参数化设计
- 动态调整预冷器出口温度(T9)
- 多参数优化搜索
- 综合热效率和火用效率评价

## 2. 系统架构

### 2.1 关键变量设计
系统基于四个关键变量进行参数计算：

1. **SCBC透平入口温度 (T5)**：
   - 默认值：599.85°C
   - 作用：决定循环的最高温度，影响热效率和火用效率

2. **SCBC主循环压比 (PR)**：
   - 默认值：3.27
   - 作用：影响循环的温升、热效率和功率输出

3. **ORC透平膨胀比**：
   - 默认值：3.37
   - 作用：决定ORC透平的压力降和输出功

4. **ORC透平入口温度**：
   - 默认值：127.76°C
   - 作用：影响ORC循环的最高温度和效率

### 2.2 循环结构
- **SCBC主循环**：使用超临界CO2作为工质
  - 主压缩机(MC)、再压缩机(RC)、透平(T)
  - 高温回热器(HTR)、低温回热器(LTR)
  - 加热器(ER)、预冷器(CS)
  
- **ORC余热回收循环**：使用R245fa作为工质
  - 泵(PO)、透平(TO)
  - 蒸发器(GO，与SCBC循环耦合)
  - 冷凝器(CO)

### 2.3 软件架构
```
核心计算引擎                  参数管理                分析工具
┌───────────────┐        ┌──────────────┐        ┌───────────────┐
│state_point_   │        │cycle_setup_  │        │run_pr_        │
│calculator.py  │───────▶│parameters.json│◀───────│sensitivity_   │
└───────┬───────┘        └──────────────┘        │analysis.py    │
        │                        ▲                └───────┬───────┘
        ▼                        │                        │
┌───────────────┐        ┌──────────────┐                 │
│cycle_         │        │modify_cycle_ │                 │
│components.py  │        │parameters.py │◀────────────────┘
└───────┬───────┘        └──────────────┘
        │                        ▲
        ▼                        │
┌───────────────┐                │
│full_cycle_    │────────────────┘
│simulator.py   │
└───────────────┘
```

## 3. 最新功能

### 3.1 基于关键变量的参数计算
系统实现了基于四个关键变量的参数计算机制：
- 使用 `calculate_parameters_from_key_variables` 函数计算其他参数
- 自动计算预冷器出口温度、ORC蒸发压力等参数
- 保持部分经验值不变，确保系统稳定性

### 3.2 预冷器出口温度(T9)动态调整
T9温度是影响系统性能的关键参数，已实现随压比动态变化的机制：
```
T9 = base_T9 + sensitivity_factor * (PR - base_PR)
```
- 基准温度(base_T9): 84.38°C (对应压比3.27)
- 敏感度系数: 5.0°C/PR单位

### 3.3 参数敏感性分析
实现了对系统关键参数的敏感性分析功能，可扫描压比范围自动计算系统性能，并记录结果。

### 3.4 性能可视化
通过`plot_pr_sensitivity.py`工具将参数敏感性分析结果绘制为图表，直观展示系统性能趋势。主要图表包括：
- **总热效率与功率关系图**：展示压比对总热效率、SCBC净功率和ORC净功率的影响
- **火用效率分析图**：展示压比对总火用效率的影响，并标注卡诺效率基准线

### 3.5 多目标优化
使用遗传算法(`genetic_algorithm_optimizer.py`)实现系统参数的多目标优化，同时考虑热效率、㶲效率和系统成本。

### 3.6 火用效率与卡诺效率对比
系统添加了理论卡诺效率计算与比较功能：
- 卡诺效率作为理论热效率上限（约66.65%）
- 火用效率与卡诺效率的比值作为衡量系统性能的重要指标
- 在敏感性分析中固定T5温度，使卡诺效率保持不变，以便更清晰地分析压比对系统性能的纯粹影响

## 4. 参数配置

### 4.1 关键变量配置
| 参数 | 说明 | 优化值 | 范围 |
|------|------|--------|------|
| T5_turbine_inlet_C | SCBC透平入口温度(°C) | 599.85 | 500-600 |
| PR_scbc_mc_rc | SCBC主循环压比 | 3.27 | 2.2-4.0 |
| target_PR_orc_expansion_ratio | ORC透平膨胀比 | 3.37 | 2.0-4.0 |
| target_theta_w_orc_turbine_inlet_C | ORC透平入口温度(°C) | 127.76 | 100-130 |

### 4.2 计算参数
| 参数 | 说明 | 计算方法 | 默认值 |
|------|------|----------|--------|
| T9_precooler_outlet_C | 预冷器出口温度(°C) | T9 = base_T9 + sensitivity_factor * (PR - base_PR) | 84.38 |
| P_eva_kPa_orc | ORC蒸发压力(kPa) | 根据ORC透平入口温度和膨胀比计算 | 1156.61 |
| T_pump_inlet_orc_C | ORC泵入口温度(°C) | 根据冷凝温度和过冷度计算 | 49.90 |

## 5. 最新分析结果

### 5.1 热力学效率计算说明
系统使用三种效率评价指标：

1. **总热效率(η_th)**：
   ```
   η_th = W_net / Q_in
   ```
   - W_net：SCBC和ORC循环的总净功率
   - Q_in：SCBC加热器吸收的热量

2. **火用效率(η_ex)**：
   ```
   η_ex = W_net / E_in = W_net / (Q_in * (1 - T0/T_source))
   ```
   - E_in：热输入的火用值
   - T0：环境参考温度（9.56°C）
   - T_source：热源温度（SCBC透平入口温度T5 = 599.85°C）

3. **卡诺效率(η_carnot)**：
   ```
   η_carnot = 1 - T0/T_source
   ```
   - 理论最大效率（约66.65%）
   - 在压比敏感性分析中保持不变（设计选择）

4. **火用效率/卡诺效率比值**：
   ```
   Ratio = η_ex / η_carnot
   ```
   - 表示系统达到理论效率上限的程度
   - 越接近1表示系统越接近理想状态

### 5.2 压比敏感性分析结果
| PR_scbc | 总热效率(%) | 总火用效率(%) | SCBC净功率(MW) | ORC净功率(MW) | T9温度(°C) |
|---------|------------|--------------|--------------|-------------|----------|
| 2.2     | 42.12      | 63.21        | 242.02       | 10.48       | 79.03    |
| 2.6     | 43.33      | 64.92        | 248.27       | 11.48       | 81.03    |
| 3.0     | 43.80      | 65.68        | 250.40       | 12.24       | 83.03    |
| 3.2     | 43.87      | 65.79        | 250.49       | 12.55       | 84.03    |
| 3.6     | 43.78      | 65.66        | 249.77       | 13.10       | 86.03    |
| 4.0     | 43.52      | 65.27        | 247.75       | 13.56       | 88.03    |

注：卡诺效率在所有压比点均为66.65%（由于T5固定）

### 5.3 关键发现
1. 系统在PR=3.2附近达到最高总热效率(43.87%)和最高火用效率(65.79%)
2. 火用效率最高点达到了理论卡诺效率的98.7%，表明系统设计非常高效
3. SCBC净功率在PR=3.2附近达到最大值(250.49 MW)
4. ORC净功率随T9温度升高而单调增加，最高达13.56 MW (PR=4.0时)
5. 在最优总效率点，ORC贡献约为总功率的4.8%
6. 卡诺效率保持不变是敏感性分析的设计选择，目的是隔离压比变化的纯粹影响

## 6. 使用指南

### 6.1 基本操作流程
1. **初始化参数**
   ```bash
   python state_point_calculator.py
   ```

2. **单次模拟**
   ```bash
   python full_cycle_simulator.py
   ```

3. **修改关键变量**
   ```bash
   python modify_cycle_parameters.py --t5_c 599.85 --pr_scbc 3.2 --pr_orc 3.37 --theta_w_c 127.76
   ```

4. **参数敏感性分析**
   ```bash
   python run_pr_sensitivity_analysis.py
   ```

5. **结果可视化**
   ```bash
   python plot_pr_sensitivity.py
   ```

6. **系统优化**
   ```bash
   python genetic_algorithm_optimizer.py
   ```

### 6.2 主要输出文件
- `cycle_setup_parameters.json`: 系统参数配置
- `calculated_state_points_from_table10.csv`: 状态点计算结果
- `pr_sensitivity_results.csv`: 参数敏感性分析结果
- `pr_sensitivity_plot.png`: 热效率与功率曲线图
- `pr_exergy_efficiency_plot.png`: 火用效率分析图

## 7. 代码结构

### 7.1 核心文件
- `state_point_calculator.py`: 状态点计算与物性模块
- `cycle_components.py`: 循环组件模型库
- `full_cycle_simulator.py`: 完整循环模拟器
- `modify_cycle_parameters.py`: 参数修改工具
- `run_pr_sensitivity_analysis.py`: 敏感性分析工具
- `plot_pr_sensitivity.py`: 结果可视化工具
- `genetic_algorithm_optimizer.py`: 多目标优化模块

### 7.2 数据流向
1. `state_point_calculator.py` 提供物性计算能力
2. `cycle_components.py` 实现各组件的数学模型
3. `full_cycle_simulator.py` 集成组件模型模拟完整循环
4. `modify_cycle_parameters.py` 修改系统参数
5. `run_pr_sensitivity_analysis.py` 执行参数扫描分析
6. `plot_pr_sensitivity.py` 绘制性能曲线图表
7. `genetic_algorithm_optimizer.py` 执行系统优化

## 8. 物性计算与验证

### 8.1 物性计算方法
- 使用CoolProp库计算工质热力学性质
- 基于环境参考态(T0=9.56°C, P0=101.382 kPa)计算㶲值

### 8.2 误差分析
- SCBC循环(CO2)㶲值误差: -0.17 ~ -0.52 kJ/kg
- ORC循环(R245fa)㶲值误差: 0.06 ~ 0.23 kJ/kg
- 误差来源: 物性计算模型差异、数值计算精度

## 9. 未来工作

### 9.1 模型改进
- 完善T9与压比的关系模型，考虑非线性因素
- 添加更多循环参数的敏感性分析
- 实现多参数联合优化
- 拓展卡诺效率分析，考虑热源温度变化情况

### 9.2 功能扩展
- 增强可视化能力，支持更多性能指标分析
- 添加不同工质组合的对比分析
- 实现经济性评价模块
- 开发热力学第二定律损失分析功能

### 9.3 软件优化
- 改进迭代算法，提高计算效率
- 增强错误处理和异常识别
- 开发更友好的用户界面
- 优化参数敏感性分析过程，支持并行计算